/*!
	$Workfile:: fp_js001.js                 $
	$UTCDate:: 2011-10-21 05:42:41Z         $
	$Revision:: 9                           $
*/
function FP_JS001_Object(argobjDate){this._selectedDate=argobjDate;this._matrix=[[],[],[],[],[],[],[]];this._showNone=true;this._showToday=true;this._firstWeekDay=0;this._redWeekDay=6;this._dontChangeNone=false;}FP_JS001_Object.prototype.create=FP_JS001_PUBLIC_Create;FP_JS001_Object.prototype._createTable=FP_JS001_PUBLIC_CreateTable;FP_JS001_Object.prototype.setDate=FP_JS001_PUBLIC_SetDate;
FP_JS001_Object.prototype.getDate=FP_JS001_PUBLIC_GetDate;FP_JS001_Object.prototype._updateTable=FP_JS001_PUBLIC_UpdateTable;FP_JS001_Object.prototype._setTopLabel=FP_JS001_PUBLIC_SetTopLabel;FP_JS001_Object.prototype.goToNextMonth=FP_JS001_PUBLIC_GoToNextMonth;FP_JS001_Object.prototype.goToPreviousMonth=FP_JS001_PUBLIC_GoToPreviousMonth;function FP_JS001_PUBLIC_Create(doc){this._el=document.createElement("div");this._el.className="datePicker";var div=document.createElement("div");div.className="header";
this._el.appendChild(div);var headerTable=document.createElement("table");headerTable.className="headerTable";headerTable.cellSpacing=0;div.appendChild(headerTable);var tBody=document.createElement("tbody");headerTable.appendChild(tBody);var tr=document.createElement("tr");tBody.appendChild(tr);var td=document.createElement("td");this._previousMonth=document.createElement("span");this._previousMonth.className="previousButton";td.appendChild(this._previousMonth);this._previousMonthIMG=document.createElement("img");
this._previousMonthIMG.src="fp_im004.gif";this._previousMonthIMG.id="VF_HT003_PreviousButton";this._previousMonth.appendChild(this._previousMonthIMG);tr.appendChild(td);td=document.createElement("td");td.className="labelContainer";tr.appendChild(td);this._topLabel=document.createElement("span");this._topLabel.className="topLabel";this._topLabel.href="#";this._topLabel.appendChild(document.createTextNode(String.fromCharCode(160)));td.appendChild(this._topLabel);td=document.createElement("td");this._nextMonth=document.createElement("span");
this._nextMonth.className="nextButton";td.appendChild(this._nextMonth);this._nextMonthIMG=document.createElement("img");this._nextMonthIMG.src="fp_im005.gif";this._nextMonthIMG.id="VF_HT003_NextButton";this._nextMonth.appendChild(this._nextMonthIMG);tr.appendChild(td);div=document.createElement("div");div.className="grid";this._el.appendChild(div);this._table=div;this._createTable(doc);this._updateTable();this._setTopLabel();if(!this._showNone){this._noneButton.style.visibility="hidden";}if(!this._showToday){this._todayButton.style.visibility="hidden";
}this._previousMonth.hideFocus=true;this._nextMonth.hideFocus=true;var dp=this;this._previousMonth.onclick=function(){dp._dontChangeNone=true;dp.goToPreviousMonth();dp._dontChangeNone=false;};this._nextMonth.onclick=function(){dp._dontChangeNone=true;dp.goToNextMonth();dp._dontChangeNone=false;};this._el.onselectstart=function(){return false;};this._table.onclick=function(e){if(e==null){e=document.parentWindow.event;}var el=e.target!=null?e.target:e.srcElement;while(el.nodeType!=1){el=el.parentNode;
}while(el!=null&&el.tagName&&el.tagName.toLowerCase()!="td"){el=el.parentNode;}if(el==null||el.tagName==null||el.tagName.toLowerCase()!="td"){return;}var d=new Date(dp._selectedDate);var n=Number(el.firstChild.data);if(isNaN(n)||n<=0||n==null){return;}d.setDate(n);dp.setDate(d);if(typeof dp.ondateselected=="function"){dp.ondateselected();}};this._el.onkeydown=function(e){if(e==null){e=document.parentWindow.event;}var kc=e.keyCode!=null?e.keyCode:e.charCode;if(kc<37||kc>40){return true;}var d=new Date(dp._selectedDate).valueOf();
if(kc==37){d-=24*60*60*1000;}else{if(kc==39){d+=24*60*60*1000;}else{if(kc==38){d-=7*24*60*60*1000;}else{if(kc==40){d+=7*24*60*60*1000;}}}}dp.setDate(new Date(d));return false;};return this._el;}function FP_JS001_PUBLIC_SetDate(argobjDate){if(typeof argobjDate=="string"||typeof argobjDate=="number"){argobjDate=new Date(argobjDate);}if(this._selectedDate.getDate()!=argobjDate.getDate()||this._selectedDate.getMonth()!=argobjDate.getMonth()||this._selectedDate.getFullYear()!=argobjDate.getFullYear()||this._none){this._selectedDate=new Date(argobjDate);
this._setTopLabel();this._updateTable();if(typeof this.onchange=="function"){this.onchange();}}}function FP_JS001_PUBLIC_GetDate(){if(this._none){return null;}return new Date(this._selectedDate);}function FP_JS001_PUBLIC_CreateTable(doc){var str,i;var rows=6;var cols=7;var currentWeek=0;var table=document.createElement("table");table.className="gridTable";table.cellSpacing=0;var tBody=document.createElement("tbody");table.appendChild(tBody);var tr=document.createElement("tr");tr.className="daysRow";
var td,tn;var nbsp=String.fromCharCode(160);for(i=0;i<cols;i++){td=document.createElement("td");td.appendChild(document.createTextNode(nbsp));tr.appendChild(td);}tBody.appendChild(tr);tr=document.createElement("tr");td=document.createElement("td");td.className="upperLine";td.colSpan=7;tr.appendChild(td);tBody.appendChild(tr);for(i=0;i<rows;i++){tr=document.createElement("tr");for(var j=0;j<cols;j++){td=document.createElement("td");td.appendChild(document.createTextNode(nbsp));tr.appendChild(td);}tBody.appendChild(tr);
}str+="</table>";if(this._table!=null){this._table.appendChild(table);}}function FP_JS001_PUBLIC_UpdateTable(){if(this._table==null){return;}var i;var str="";var rows=6;var cols=7;var currentWeek=0;var cells=new Array(rows);this._matrix=new Array(rows);for(i=0;i<rows;i++){cells[i]=new Array(cols);this._matrix[i]=new Array(cols);}var tmpDate=new Date(this._selectedDate.getFullYear(),this._selectedDate.getMonth(),1);var today=new Date();for(i=1;i<32;i++){tmpDate.setDate(i);var weekDay=(tmpDate.getDay()+6)%7;
var colIndex=(weekDay-this._firstWeekDay+7)%7;if(tmpDate.getMonth()==this._selectedDate.getMonth()){var isToday=tmpDate.getDate()==today.getDate()&&tmpDate.getMonth()==today.getMonth()&&tmpDate.getFullYear()==today.getFullYear();cells[currentWeek][colIndex]={text:"",className:""};if(this._selectedDate.getDate()==tmpDate.getDate()&&!this._none){cells[currentWeek][colIndex].className+="selected ";}if(isToday){cells[currentWeek][colIndex].className+="today ";}if((tmpDate.getDay()+6)%7==this._redWeekDay){cells[currentWeek][colIndex].className+="red";
}cells[currentWeek][colIndex].text=this._matrix[currentWeek][colIndex]=tmpDate.getDate();if(colIndex==6){currentWeek++;}}}var weekDays=FP_JS001_Object.days;if(this._firstWeekDay!=0){weekDays=new Array(7);for(i=0;i<7;i++){weekDays[i]=FP_JS001_Object.days[(i+this._firstWeekDay)%7];}}var tds=this._table.firstChild.tBodies[0].rows[0].cells;for(i=0;i<cols;i++){tds[i].firstChild.data=weekDays[i];}var trs=this._table.firstChild.tBodies[0].rows;var tmpCell;var nbsp=String.fromCharCode(160);for(var y=0;y<rows;
y++){for(var x=0;x<cols;x++){tmpCell=trs[y+2].cells[x];if(typeof cells[y][x]!="undefined"){tmpCell.className=cells[y][x].className;tmpCell.firstChild.data=cells[y][x].text;}else{tmpCell.className="";tmpCell.firstChild.data=nbsp;}}}}function FP_JS001_PUBLIC_SetTopLabel(){var str=this._selectedDate.getFullYear()+" "+FP_JS001_Object.months[this._selectedDate.getMonth()];if(this._topLabel!=null){this._topLabel.lastChild.data=str;}}function FP_JS001_PUBLIC_GoToNextMonth(){var objDate=new Date(this._selectedDate);
var newMonth=objDate.getMonth()+1;objDate.setMonth(newMonth);if(newMonth>11){newMonth=0;}if(objDate.getMonth()!=newMonth){objDate.setDate(0);}this.setDate(objDate);}function FP_JS001_PUBLIC_GoToPreviousMonth(){var objDate=new Date(this._selectedDate);var newMonth=objDate.getMonth()-1;objDate.setMonth(newMonth);if(newMonth<0){newMonth=11;}if(objDate.getMonth()!=newMonth){objDate.setDate(0);}this.setDate(objDate);}