/*!
	$Workfile:: castlebusybox.js            $
	$UTCDate:: 2011-10-21 05:42:41Z         $
	$Revision:: 5                           $
	 ---------------------------
	Legal
	 ---------------------------
	CastleBusyBox Control
	Castle Rock Software, LLC
	by Mark Wagner
	http://www.crsw.com
	Version: 1.2
	Copyright 2004, 2005 Castle Rock Software, LLC
	No warranty express or implied.
*/
function BusyBox(id,varName,imageCount,imageNamePrefix,imageNameSuffix,imageDelay,width,height,url,msg){this.id=id;this.ImageCount=imageCount;this.CurrentImageIndex=0;this.ImageWidth=0;this.ImageHeight=0;this.ImageNamePrefix=imageNamePrefix;this.ImageNameSuffix=imageNameSuffix;this.ImageDelay=imageDelay;this.DivID="BusyBoxDiv";this.ImgID="BusyBoxImg";this.Enabled=true;this.Width=width;this.Height=height;this.Msg=msg!=null?msg:"Processing";this.VarName=varName;this.timeout_id=null;this.CacheImages();this.BusyBoxUrl=url;this.IFrame=document.getElementById(this.id);if(this.IFrame==null){this.IFrame=this.CreateIFrame();}this.Hide();if(this.BusyBoxUrl){this.LoadUrl(this.BusyBoxUrl);}else{this.RenderContent();}if(!frames[this.id]){this.Enabled=false;}}BusyBox.prototype.GetIFrameDocument=function(){var doc;if(this.IFrame.contentDocument){doc=this.IFrame.contentDocument;}else{if(this.IFrame.contentWindow){doc=this.IFrame.contentWindow.document;}else{if(this.IFrame.document){doc=this.IFrame.document;}else{doc=this.IFrame.document;}}}return doc;};BusyBox.prototype.LoadUrl=function(url){var IFrameDoc=this.GetIFrameDocument();IFrameDoc.location.replace(url);};BusyBox.prototype.CreateIFrame=function(){var IFrame=document.createElement("iframe");IFrame.id=this.id;IFrame.name=this.id;IFrame.style.borderStyle="none";IFrame.style.margin="0px";IFrame.style.padding="0px";IFrame.scrolling="no";IFrame.ondrop="return false;";document.body.appendChild(IFrame);return IFrame;};BusyBox.prototype.RenderContent=function(){var doc=this.GetIFrameDocument();var style=" style='border: navy 3px solid; position: absolute;' ";doc.open();doc.writeln("<html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title></title></head><body ondragstart='return false;' style='margin:0px; background-color:white;'>");doc.writeln("<div id='"+this.DivID+"' align=center "+style+">");doc.writeln("<img id='"+this.ImgID+"' src=''>");doc.writeln("<br /><h3>"+this.Msg+"</h3>");doc.writeln("</div></body></html>");doc.close();};BusyBox.prototype.Resize=function(){if(BusyBox.IsBrowserIE()){var body=frames[this.id].document.body;this.IFrame.style.width=body.scrollWidth+7;this.IFrame.style.height=body.scrollHeight+7;}else{this.IFrame.style.width=this.Width;this.IFrame.style.height=this.Height;}};BusyBox.prototype.Center=function(){if(!this.IFrame){return;}var objLeft=(document.body.clientWidth-this.IFrame.offsetWidth)/2;var objTop=(document.body.clientHeight-this.IFrame.offsetHeight)/2;objLeft=objLeft+document.body.scrollLeft;objTop=objTop+document.body.scrollTop;this.IFrame.style.position="absolute";this.IFrame.style.top=objTop;this.IFrame.style.left=objLeft;};BusyBox.prototype.CacheImages=function(){this.Images=new Array(this.ImageCount);for(var i=0;i<this.ImageCount;i++){this.Images[i]=new Image();this.Images[i].src=this.ImageNamePrefix+i+this.ImageNameSuffix;}};BusyBox.prototype.IsAnimating=function(){if(this.timeout_id==null){return false;}else{return true;}};BusyBox.prototype.IsVisible=function(){var ifrm=document.getElementById(this.id);if(ifrm.style.visibility=="visible"&&ifrm.style.width>0){return true;}else{return false;}};BusyBox.prototype.Animate=function(){if(frames[this.id]){frames[this.id].document.getElementById(this.ImgID).src=this.Images[this.CurrentImageIndex].src;}else{document.getElementById(this.ImgID).src=this.Images[this.CurrentImageIndex].src;}this.Resize();this.Center();this.CurrentImageIndex=(this.CurrentImageIndex+1)%this.ImageCount;this.timeout_id=setTimeout(this.VarName+".Animate();",this.ImageDelay);};BusyBox.prototype.StartAnimate=function(){if(this.IsAnimating()){return;}this.Animate();};BusyBox.prototype.StopAnimate=function(){clearTimeout(this.timeout_id);this.timeout_id=null;};BusyBox.prototype.Hide=function(){this.StopAnimate();this.IFrame.style.visibility="hidden";this.IFrame.style.width=0;this.IFrame.style.height=0;};BusyBox.prototype.Show=function(){if(!this.Enabled){return;}if(this.IsAnimating()||this.IsVisible()){return;}this.Resize();this.Center();this.IFrame.style.visibility="visible";this.IFrame.style.zIndex="999999";this.StartAnimate();};BusyBox.IsBrowserIE=function(){try{return(window.navigator.userAgent.indexOf("MSIE ")>0);}catch(x){return false;}};BusyBox.IsBrowserNS=function(){try{return(window.navigator.userAgent.indexOf("Netscape")>0);}catch(x){return false;}};BusyBox.IsBrowserFirefox=function(){try{return(window.navigator.userAgent.indexOf("Firefox")>0);}catch(x){return false;}};